# Stream

Redis5.0中添加了这一数据类型。有对Message Queue较为完整的实现。Redis作为消息队列其实并不是一个很好的选择，如果不需要对消息队列有很高的要求，使用List LPUSH+BRPOP就可以实现一个简单的消息队列。如果需要复杂的消息队列为何不直接使用[RabbitMQ](https://www.beyondhorizon.top/article/D06pcnSn)。所以这里先跳过了对Stream 的学习。如果以后必须要求使用Stream，会回来再学习。😊

# Redis的优势

- Redis基于内存，内存访问速度大幅高于磁盘
- 单线程 + 多路IO复用
- 对数据结构大幅优化

>  Q1：String和Hash存储对象有什么不同
>
>  String的缺点：String存储序列化之后的对象，如果后续要对对象操作（如修改，增加，删除字段）需要读取整个String操作，操作稳之后再存入Redis。String不是和存储需要经常改变的对象。


Hash的优点：支持单独对对象中的个别字段做修改，每次只需读取一个字段的数据，更加节省网络带宽。

String的优势：相对于Hash等节省内存，缓存相同数量的对象数据，String消耗的内存是Hash的一半。

# 线程模型

对于读写命令，Redis是单线程。Redis4.0引入多线程来执行大Key的异步删除。Redis6.0引入多线程处理网路请求，提高网络IO读写性能。

# 数据删除策略

- 惰性删除：在取出key的时候检查过期，如果过期就删除
- 定期删除：每隔一段时间，检查key，过期则删除

# 持久化

## RDB（快照）

通过定时创建数据库快照，来恢复数据

## AOF

记录在Redis中执行的指令，可以设置保存每条指令，或一秒钟保存一次，一次保存多条指令。

当AOF文件很大时，重写AOF文件，包含之前的所有指令但是体积更小

## 对比

RDB记录的是数据本省，AOF记录的是写入数据的指令。

在恢复时，RDB只需恢复数据，AOF需要重新执行一遍指令。
